---
import { getCollection } from "astro:content";
import InfoPage from "../components/InfoPage.astro";
import LesgeversPage from "../components/LesgeversPage.astro";

export async function getStaticPaths() {
  const pages = await getCollection("pages");
  return pages.map((page) => ({
    params: { slug: page.slug },
    props: page,
  }));
}

const page = Astro.props;
const pageType = page.data.type || "info";

// Dynamic import for hero image if it exists
let heroImage: any = null;
if (page.data.heroImage) {
  try {
    const images = import.meta.glob(
      "/src/assets/images/**/*.{jpeg,jpg,png,gif,webp}"
    );
    const imagePath = `/src/assets/images/${page.data.heroImage}`;
    if (images[imagePath]) {
      const imageModule = (await images[imagePath]()) as any;
      heroImage = imageModule.default;
    }
  } catch (error) {
    console.error("Error loading hero image:", error);
  }
}
---

{
  pageType === "lesgevers" && (
    <LesgeversPage page={page} heroImage={heroImage} />
  )
}

{pageType === "info" && <InfoPage page={page} heroImage={heroImage} />}

{
  !["lesgevers", "info"].includes(pageType) && (
    <InfoPage page={page} heroImage={heroImage} />
  )
}
